# Microplastic Detection via Raman Spectroscopy

This project aims to automate the detection and identification of microplastics in water samples using Raman spectroscopy and advanced machine learning. By analyzing the unique vibrational "fingerprints" of polymers, we can identify contaminants even at low concentrations.

## üåü Project Overview
Microplastics are a growing environmental threat. Traditional manual identification is slow and error-prone. This project provides a robust pipeline to:
- **Process Raw Spectra**: Handle proprietary vendor formats (.spc, .jws).
- **Multi-Laser Support**: Designed to work with Green, Red, and Blue laser inputs for comprehensive detection.
- **Advanced AI**: Leverages state-of-the-art architectures like **PlasticNet** and our custom **MENNet** (CNN+GRU) for high-accuracy classification and transfer learning.

## ‚ö†Ô∏è Missing Data & Setup

To keep the repository lightweight, the raw data and generated artifacts are ignored by git. You will need to set them up locally:

### 1. Raw Data (`archive/`)
The raw Raman spectra (in `.spc`, `.jws`, and `.jwa` formats) should be placed in the `archive/` folder at the root of the project.
- If you have `archive.zip`, extract it into the root directory:
  ```bash
  unzip archive.zip
  ```

### 2. Derived Data (`derived/`)
This folder is automatically generated by the scripts and contains:
- `spc_csv/`: Converted spectral data in CSV format.
- `models/`: Trained ML models (Random Forest, One-Class SVM, PlasticNet, MENNet, etc.).
- `plots/`: Visualization of accuracies and confusion matrices.
- `logs/`: Detailed classification reports.

## üöÄ Getting Started

### Prerequisites
- Python 3.10+
- Recommended: A virtual environment (`.venv`)

### Installation
1. Create and activate a virtual environment:
   ```bash
   python -m venv .venv
   source .venv/bin/activate  # On Windows: .venv\Scripts\activate
   ```
2. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```

### Running the Pipeline
1. **Index the Archive**: Scan the raw data to generate a summary.
   ```bash
   python scripts/index_archive.py
   ```
2. **Convert Spectra**: Convert binary `.spc` files to CSV for processing.
   ```bash
   python scripts/convert_spc_to_csv.py
   ```
3. **Train Models**: Train the 6 ML/DL models (including MENNet and PlasticNet) and generate visualizations.
   ```bash
   python scripts/train_models.py
   ```

## üß† Models Included
- **Random Forest**: Baseline classifier.
- **One-Class SVM**: Anomaly detection.
- **One-Class CNN**: Deep learning for single-class detection.
- **One-Class CNN+GRU**: Hybrid temporal-spatial model.
- **PlasticNet**: Specialized CNN for spectral data.
- **MENNet**: Our innovative model optimized for transfer learning.

## üìä Visualizations
After running the training script, check `derived/plots/` for:
- `model_accuracies.png`: Comparison of all 6 models.
- `*_confusion_matrix.png`: Detailed performance for each model.
